<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>StateFS: Fake Power provider example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">StateFS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Fake Power provider example</div>  </div>
</div><!--header-->
<div class="contents">

<p>Example provider - provides fake power supply properties.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstatefs__power__prop.html">statefs_power_prop</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpower__handle.html">power_handle</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga13b6f2352363b3dc4f3b8599999f3c80"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga13b6f2352363b3dc4f3b8599999f3c80"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>iv_max_size</b>&#160;&#160;&#160;(sizeof(max_iv_fmt) - 1)</td></tr>
<tr class="separator:ga13b6f2352363b3dc4f3b8599999f3c80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2ce6eac6657b2302ca8e098d27e64a70"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga2ce6eac6657b2302ca8e098d27e64a70"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>is_low_max_len</b>&#160;&#160;&#160;sizeof(is_low_fmt)</td></tr>
<tr class="separator:ga2ce6eac6657b2302ca8e098d27e64a70"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaaa69df49e80e4492ea96923a0a2af4f9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaaa69df49e80e4492ea96923a0a2af4f9"></a>
static void *&#160;</td><td class="memItemRight" valign="bottom"><b>control_thread</b> (void *)</td></tr>
<tr class="separator:gaaa69df49e80e4492ea96923a0a2af4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa3853b9ba3163d776b666d589e1b1c12"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa3853b9ba3163d776b666d589e1b1c12"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>power_init</b> ()</td></tr>
<tr class="separator:gaa3853b9ba3163d776b666d589e1b1c12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6416d6a3cf8e16ad9cd7448516a81675"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga6416d6a3cf8e16ad9cd7448516a81675"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>read_voltage</b> (char *dst, statefs_size_t len)</td></tr>
<tr class="separator:ga6416d6a3cf8e16ad9cd7448516a81675"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga38e476e7578521ec3c98ac9e8a380524"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga38e476e7578521ec3c98ac9e8a380524"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>read_current</b> (char *dst, statefs_size_t len)</td></tr>
<tr class="separator:ga38e476e7578521ec3c98ac9e8a380524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga68d8dcc9cf38b7829a516404f4b56e14"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga68d8dcc9cf38b7829a516404f4b56e14"></a>
static bool&#160;</td><td class="memItemRight" valign="bottom"><b>update_is_low</b> ()</td></tr>
<tr class="separator:ga68d8dcc9cf38b7829a516404f4b56e14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga313b7f585e781576ac7b3e6a4260639f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga313b7f585e781576ac7b3e6a4260639f"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>read_is_low</b> (char *dst, statefs_size_t len)</td></tr>
<tr class="separator:ga313b7f585e781576ac7b3e6a4260639f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf4729a050f8799faa7014725659e6be6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaf4729a050f8799faa7014725659e6be6"></a>
static struct <a class="el" href="structstatefs__power__prop.html">statefs_power_prop</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>power_prop</b> (struct <a class="el" href="structstatefs__property.html">statefs_property</a> *p)</td></tr>
<tr class="separator:gaf4729a050f8799faa7014725659e6be6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf1de2e56a2e8c9b7bb2469cef12dd617"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaf1de2e56a2e8c9b7bb2469cef12dd617"></a>
static struct <a class="el" href="structstatefs__node.html">statefs_node</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>prop_find</b> (struct <a class="el" href="structstatefs__branch.html">statefs_branch</a> const *self, char const *name)</td></tr>
<tr class="separator:gaf1de2e56a2e8c9b7bb2469cef12dd617"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga13c3827b750c57ec5e33b8086cfcdb52"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga13c3827b750c57ec5e33b8086cfcdb52"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>prop_next</b> (struct <a class="el" href="structstatefs__branch.html">statefs_branch</a> const *self, statefs_handle_t *idx_ptr)</td></tr>
<tr class="separator:ga13c3827b750c57ec5e33b8086cfcdb52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab100dedbfe9592dbf4c5370ec0518c7c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gab100dedbfe9592dbf4c5370ec0518c7c"></a>
static struct <a class="el" href="structstatefs__node.html">statefs_node</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>prop_get</b> (struct <a class="el" href="structstatefs__branch.html">statefs_branch</a> const *self, statefs_handle_t idx)</td></tr>
<tr class="separator:gab100dedbfe9592dbf4c5370ec0518c7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga74cff99b0f0fc9f04c3efff9a8a62d25"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga74cff99b0f0fc9f04c3efff9a8a62d25"></a>
static statefs_handle_t&#160;</td><td class="memItemRight" valign="bottom"><b>prop_first</b> (struct <a class="el" href="structstatefs__branch.html">statefs_branch</a> const *self)</td></tr>
<tr class="separator:ga74cff99b0f0fc9f04c3efff9a8a62d25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8f743b7ed363869d9725bbab53857400"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga8f743b7ed363869d9725bbab53857400"></a>
static struct <a class="el" href="structstatefs__node.html">statefs_node</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>ns_find</b> (struct <a class="el" href="structstatefs__branch.html">statefs_branch</a> const *self, char const *name)</td></tr>
<tr class="separator:ga8f743b7ed363869d9725bbab53857400"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5c8dd264238a13063a0fa3184972104d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga5c8dd264238a13063a0fa3184972104d"></a>
static struct <a class="el" href="structstatefs__node.html">statefs_node</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>ns_get</b> (struct <a class="el" href="structstatefs__branch.html">statefs_branch</a> const *self, statefs_handle_t p)</td></tr>
<tr class="separator:ga5c8dd264238a13063a0fa3184972104d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga95fa85004abc2e4c6e1c4440001452a3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga95fa85004abc2e4c6e1c4440001452a3"></a>
static statefs_handle_t&#160;</td><td class="memItemRight" valign="bottom"><b>ns_first</b> (struct <a class="el" href="structstatefs__branch.html">statefs_branch</a> const *self)</td></tr>
<tr class="separator:ga95fa85004abc2e4c6e1c4440001452a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa62afa8275b8f9a2d5f110b80e9ec142"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa62afa8275b8f9a2d5f110b80e9ec142"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>power_release</b> (struct <a class="el" href="structstatefs__node.html">statefs_node</a> *node)</td></tr>
<tr class="separator:gaa62afa8275b8f9a2d5f110b80e9ec142"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa4b5703862fe82c93363d0208d40507b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa4b5703862fe82c93363d0208d40507b"></a>
static bool&#160;</td><td class="memItemRight" valign="bottom"><b>power_connect</b> (struct <a class="el" href="structstatefs__property.html">statefs_property</a> *p, struct <a class="el" href="structstatefs__slot.html">statefs_slot</a> *slot)</td></tr>
<tr class="separator:gaa4b5703862fe82c93363d0208d40507b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4db84d23dff379defc89fd6fbde7640b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga4db84d23dff379defc89fd6fbde7640b"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>power_disconnect</b> (struct <a class="el" href="structstatefs__property.html">statefs_property</a> *p)</td></tr>
<tr class="separator:ga4db84d23dff379defc89fd6fbde7640b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1fb3a6b879cb4564d11b1f089b04db6b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__power__example.html#ga1fb3a6b879cb4564d11b1f089b04db6b">power_getattr</a> (struct <a class="el" href="structstatefs__property.html">statefs_property</a> const *p)</td></tr>
<tr class="separator:ga1fb3a6b879cb4564d11b1f089b04db6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad8b5bb49fb3861a246b2c7d94f1bec14"><td class="memItemLeft" align="right" valign="top">static statefs_ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__power__example.html#gad8b5bb49fb3861a246b2c7d94f1bec14">power_size</a> (struct <a class="el" href="structstatefs__property.html">statefs_property</a> const *p)</td></tr>
<tr class="separator:gad8b5bb49fb3861a246b2c7d94f1bec14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa585ffb946c3c60a238ea9792b6eba7b"><td class="memItemLeft" align="right" valign="top">static statefs_handle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__power__example.html#gaa585ffb946c3c60a238ea9792b6eba7b">power_open</a> (struct <a class="el" href="structstatefs__property.html">statefs_property</a> *p, int mode)</td></tr>
<tr class="separator:gaa585ffb946c3c60a238ea9792b6eba7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7fa5d91baa14d2a21050d80895dc1864"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__power__example.html#ga7fa5d91baa14d2a21050d80895dc1864">power_read</a> (statefs_handle_t h, char *dst, statefs_size_t len, statefs_off_t off)</td></tr>
<tr class="separator:ga7fa5d91baa14d2a21050d80895dc1864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf7a43f7f30ef12121ff8b06c73f1b1a3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaf7a43f7f30ef12121ff8b06c73f1b1a3"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>power_close</b> (statefs_handle_t h)</td></tr>
<tr class="separator:gaf7a43f7f30ef12121ff8b06c73f1b1a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga62fe870011ce6a8e569e4167e7bebfe7"><td class="memItemLeft" align="right" valign="top">static pthread_mutex_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__power__example.html#ga62fe870011ce6a8e569e4167e7bebfe7">power_mutex</a> = PTHREAD_MUTEX_INITIALIZER</td></tr>
<tr class="separator:ga62fe870011ce6a8e569e4167e7bebfe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga95cbd6b99430748422cc048b4f29dc52"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga95cbd6b99430748422cc048b4f29dc52"></a>
static bool&#160;</td><td class="memItemRight" valign="bottom"><b>is_running</b> = true</td></tr>
<tr class="separator:ga95cbd6b99430748422cc048b4f29dc52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3a5ba243b3ab4b6093afb178de0f9509"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga3a5ba243b3ab4b6093afb178de0f9509"></a>
static pthread_t&#160;</td><td class="memItemRight" valign="bottom"><b>tid</b></td></tr>
<tr class="separator:ga3a5ba243b3ab4b6093afb178de0f9509"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2828ff34838e31a9a9859f21250bd8af"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga2828ff34838e31a9a9859f21250bd8af"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><b>voltage_now</b> = 3.6</td></tr>
<tr class="separator:ga2828ff34838e31a9a9859f21250bd8af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa245a226f7d0d766b113afc9e5824c0f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa245a226f7d0d766b113afc9e5824c0f"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><b>dvoltage</b> = 0.1</td></tr>
<tr class="separator:gaa245a226f7d0d766b113afc9e5824c0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga17a858fea11210a12c6c54028a72cb77"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga17a858fea11210a12c6c54028a72cb77"></a>
static const char&#160;</td><td class="memItemRight" valign="bottom"><b>max_iv_fmt</b> [] = &quot;1.0000&quot;</td></tr>
<tr class="separator:ga17a858fea11210a12c6c54028a72cb77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga72adce18aca34a54ff3f2a0a4e12f333"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga72adce18aca34a54ff3f2a0a4e12f333"></a>
static bool&#160;</td><td class="memItemRight" valign="bottom"><b>power_is_initialized</b> = false</td></tr>
<tr class="separator:ga72adce18aca34a54ff3f2a0a4e12f333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae786c23ea7d3e478037329203cb72137"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae786c23ea7d3e478037329203cb72137"></a>
static const char&#160;</td><td class="memItemRight" valign="bottom"><b>is_low_fmt</b> [] = &quot;0&quot;</td></tr>
<tr class="separator:gae786c23ea7d3e478037329203cb72137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga67e2eefcd2aa9afc220d460797cbf478"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga67e2eefcd2aa9afc220d460797cbf478"></a>
static bool&#160;</td><td class="memItemRight" valign="bottom"><b>is_low</b> = false</td></tr>
<tr class="separator:ga67e2eefcd2aa9afc220d460797cbf478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6707b48ca3c0b43d2824ff8c05d731a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gac6707b48ca3c0b43d2824ff8c05d731a"></a>
static struct <a class="el" href="structstatefs__slot.html">statefs_slot</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>is_low_slot</b> = NULL</td></tr>
<tr class="separator:gac6707b48ca3c0b43d2824ff8c05d731a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeb7815b8da6a6210b920eb6e8b46c7b1"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structstatefs__power__prop.html">statefs_power_prop</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__power__example.html#gaeb7815b8da6a6210b920eb6e8b46c7b1">props</a> []</td></tr>
<tr class="separator:gaeb7815b8da6a6210b920eb6e8b46c7b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5e803947d6dc3b5fa36acb3c8f363740"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structstatefs__namespace.html">statefs_namespace</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__power__example.html#ga5e803947d6dc3b5fa36acb3c8f363740">battery_ns</a></td></tr>
<tr class="separator:ga5e803947d6dc3b5fa36acb3c8f363740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7ff1609168c79932767f4ccbee65cb07"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structstatefs__provider.html">statefs_provider</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__power__example.html#ga7ff1609168c79932767f4ccbee65cb07">provider</a></td></tr>
<tr class="separator:ga7ff1609168c79932767f4ccbee65cb07"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Example provider - provides fake power supply properties. </p>
<p><a class="el" href="class_provider.html">Provider</a> root is <a class="el" href="group__power__example.html#ga7ff1609168c79932767f4ccbee65cb07">provider</a> (returned by <a class="el" href="group__provider__api.html#ga8ab627c705ddcc5ad9e2eaf69ac3d571">statefs_provider_get()</a>).</p>
<p>There is one <a class="el" href="group__power__example.html#ga5e803947d6dc3b5fa36acb3c8f363740">namespace</a> and <a class="el" href="group__power__example.html#gaeb7815b8da6a6210b920eb6e8b46c7b1">array</a> of properties. There are 3 properties: continuous <a class="el" href="group__power__example.html#gaeb7815b8da6a6210b920eb6e8b46c7b1">voltage</a> and <a class="el" href="group__power__example.html#gaeb7815b8da6a6210b920eb6e8b46c7b1">current</a>, and discrete <a class="el" href="group__power__example.html#gaeb7815b8da6a6210b920eb6e8b46c7b1">is_low</a>.</p>
<p>On first properties access separate thread is run starting to generate monotonous fake voltage values changes each second and updating is_low property when voltage value crosses "low voltage" barrier. Current (I, A) values are randomly generated. All values are formatted into fixed-size fields. <a class="el" href="class_provider.html">Provider</a> structures are statically defined and theoretically functionality can be taken out into framework but it was not done. Maybe later...</p>
<p>Access to any node is serialized by server, so <a class="el" href="group__power__example.html#ga62fe870011ce6a8e569e4167e7bebfe7">power_mutex</a> is used only to synchronize with voltage values generation thread </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga1fb3a6b879cb4564d11b1f089b04db6b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int power_getattr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstatefs__property.html">statefs_property</a> const *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>all example properties are read-only</p>
<p>is_low property is discrete and this is hardcoded here and also in power_connect() and power_disconnect() for simplicity </p>

</div>
</div>
<a class="anchor" id="gaa585ffb946c3c60a238ea9792b6eba7b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static statefs_handle_t power_open </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstatefs__property.html">statefs_property</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allocates <a class="el" href="structpower__handle.html">power_handle</a> structure to be used as a handle.</p>
<p>On first run also execute initialization of provider including starting of voltage values generation thread </p>

</div>
</div>
<a class="anchor" id="ga7fa5d91baa14d2a21050d80895dc1864"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int power_read </td>
          <td>(</td>
          <td class="paramtype">statefs_handle_t&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">statefs_size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">statefs_off_t&#160;</td>
          <td class="paramname"><em>off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>if reading starting from non-zero offset it is considered read operation is continued, so previous cached result is used if exists </p>

</div>
</div>
<a class="anchor" id="gad8b5bb49fb3861a246b2c7d94f1bec14"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static statefs_ssize_t power_size </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structstatefs__property.html">statefs_property</a> const *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>just return maximum size of the property </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ga5e803947d6dc3b5fa36acb3c8f363740"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structstatefs__namespace.html">statefs_namespace</a> battery_ns</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .node = {</div>
<div class="line">        .type = statefs_node_ns,</div>
<div class="line">        .name = <span class="stringliteral">&quot;battery&quot;</span>,</div>
<div class="line">    },</div>
<div class="line">    .branch = {</div>
<div class="line">        .find = prop_find,</div>
<div class="line">        .first = prop_first,</div>
<div class="line">        .next = prop_next,</div>
<div class="line">        .get = prop_get,</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>provider main (and the only) namespace </p>

</div>
</div>
<a class="anchor" id="ga62fe870011ce6a8e569e4167e7bebfe7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t power_mutex = PTHREAD_MUTEX_INITIALIZER</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>sync generation thread and property access </p>

</div>
</div>
<a class="anchor" id="gaeb7815b8da6a6210b920eb6e8b46c7b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structstatefs__power__prop.html">statefs_power_prop</a> props[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    {</div>
<div class="line">        .prop = {</div>
<div class="line">            .node = {</div>
<div class="line">                .type = statefs_node_prop,</div>
<div class="line">                .name = <span class="stringliteral">&quot;voltage&quot;</span></div>
<div class="line">            },</div>
<div class="line">            .default_value = STATEFS_REAL(3.8)</div>
<div class="line">        },</div>
<div class="line">        .read = read_voltage,</div>
<div class="line">        .max_size = iv_max_size</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">        .prop = {</div>
<div class="line">            .node = {</div>
<div class="line">                .type = statefs_node_prop,</div>
<div class="line">                .name = <span class="stringliteral">&quot;current&quot;</span></div>
<div class="line">            },</div>
<div class="line">            .default_value = STATEFS_REAL(0),</div>
<div class="line">        },</div>
<div class="line">        .read = read_current,</div>
<div class="line">        .max_size = iv_max_size</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">        .prop = {</div>
<div class="line">            .node = {</div>
<div class="line">                .type = statefs_node_prop,</div>
<div class="line">                .name = <span class="stringliteral">&quot;is_low&quot;</span></div>
<div class="line">            },</div>
<div class="line">            .default_value = STATEFS_BOOL(<span class="keyword">false</span>)</div>
<div class="line">        },</div>
<div class="line">        .read = read_is_low,</div>
<div class="line">        .max_size = is_low_max_len</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>array describing properties </p>

</div>
</div>
<a class="anchor" id="ga7ff1609168c79932767f4ccbee65cb07"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structstatefs__provider.html">statefs_provider</a> provider</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .version = STATEFS_CURRENT_VERSION,</div>
<div class="line">    .root = {</div>
<div class="line">        .node = {</div>
<div class="line">            .type = statefs_node_root,</div>
<div class="line">            .name = <span class="stringliteral">&quot;power&quot;</span>,</div>
<div class="line">            .release = &amp;power_release</div>
<div class="line">        },</div>
<div class="line">        .branch = {</div>
<div class="line">            .find = ns_find,</div>
<div class="line">            .first = &amp;ns_first,</div>
<div class="line">            .get = &amp;ns_get</div>
<div class="line">        }</div>
<div class="line">    },</div>
<div class="line">    </div>
<div class="line">    .io = {</div>
<div class="line">        .getattr = <a class="code" href="group__power__example.html#ga1fb3a6b879cb4564d11b1f089b04db6b">power_getattr</a>,</div>
<div class="line">        .open = <a class="code" href="group__power__example.html#gaa585ffb946c3c60a238ea9792b6eba7b">power_open</a>,</div>
<div class="line">        .read = <a class="code" href="group__power__example.html#ga7fa5d91baa14d2a21050d80895dc1864">power_read</a>,</div>
<div class="line">        .size = <a class="code" href="group__power__example.html#gad8b5bb49fb3861a246b2c7d94f1bec14">power_size</a>,</div>
<div class="line">        .close = power_close,</div>
<div class="line">        .connect = power_connect,</div>
<div class="line">        .disconnect = power_disconnect</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>provider root structure </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 23 2013 16:56:38 for StateFS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
